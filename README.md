# XCLOC-XLIFF Translator for Xcode

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![Python 3.6+](https://img.shields.io/badge/python-3.6+-blue.svg)](https://www.python.org/downloads/)

A Python tool to automatically translate Xcode localization XLIFF files while maintaining the original xcstrings structure.

## Features

- 🔄 Translates XLIFF files within Xcode localization bundles (.xcloc)
- 🛡️ Preserves original xcstrings files untouched
- 🧩 Maintains format specifiers like `%@`, `%d`, etc.
- 🌐 Supports all languages available in Google Translate
- 🔍 Ensures target language consistency across all files
- 🇨🇳 Special handling for Chinese Simplified (zh-Hans) and other languages
- 📊 Detailed logging of translation process

## Requirements

- Python 3.6+
- googletrans package (version 4.0.0-rc1)

## Installation

1. Clone this repository:
```bash
git clone https://github.com/yourusername/xliff-translator.git
cd xliff-translator
```

2. Install required packages:
```bash
pip install googletrans==4.0.0-rc1
```

## Usage

### Basic Usage

```bash
python xliff_translator.py --input "path/to/project.xcloc" --output "path/to/output/directory" --target_lang "zh-Hans"
```

### Arguments

- `--input`: Path to the input .xcloc bundle (generated by Xcode's "Export Localizations")
- `--output`: Path where the translated .xcloc bundle will be saved
- `--target_lang`: Target language code (e.g., en, fr, de, zh-Hans)
- `--verify-codes`: Optional flag to verify language codes against Xcode standards

## Workflow

### 1. Export Localizations from Xcode
- In Xcode, go to Product > Export Localizations...
- Save the .xcloc bundle to a location on your disk

### 2. Run the Translator Tool
```bash
python xliff_translator.py --input "YourApp.xcloc" --output "YourApp_Translated.xcloc" --target_lang "zh-Hans"
```

### 3. Import Translated Files Back to Xcode
- In Xcode, go to Product > Import Localizations...
- Select the generated .xcloc bundle from the output directory
- Review the translations and click Import

## Language Codes

The tool supports all standard Xcode language codes, including:

| Code | Language |
|------|----------|
| en | English |
| zh-Hans | Chinese Simplified |
| zh-Hant | Chinese Traditional |
| fr | French |
| de | German |
| es | Spanish |
| ja | Japanese |
| it | Italian |
| ko | Korean |
| ru | Russian |
| pt | Portuguese |
| ... | And many more |

## How It Works

1. **Reads Original Structure**: Parses the .xcloc bundle to understand the source language
2. **Updates XLIFF Files**: Only the XLIFF files are modified with translated content
3. **Preserves Format Specifiers**: Handles iOS/macOS format specifiers like `%@` correctly
4. **Fixes Inconsistencies**: Ensures all target-language attributes match the specified language
5. **Updates contents.json**: Sets the targetLocale field to the correct target language

## Common Issues & Solutions

### Language Code Inconsistencies
If you see issues with language codes, use the `--verify-codes` flag:
```bash
python xliff_translator.py --input "YourApp.xcloc" --output "YourApp_Translated.xcloc" --target_lang "zh-Hans" --verify-codes
```

### API Rate Limiting
If you're translating a large project, Google Translate might rate-limit your requests. The script includes delays to prevent this, but you might need to run it multiple times to complete all translations.

### Character Encoding Issues
The tool uses UTF-8 encoding for all file operations. If you see character encoding issues, ensure your terminal/console supports UTF-8 display.

## Logging

The tool generates a detailed log file (`xliff_translation.log`) that shows:
- Original and translated strings
- Target language changes made
- Any inconsistencies found and fixed
- Summary of translation statistics

## Contributing

Contributions are welcome! Please feel free to submit a Pull Request.

1. Fork the repository
2. Create your feature branch (`git checkout -b feature/amazing-feature`)
3. Commit your changes (`git commit -m 'Add some amazing feature'`)
4. Push to the branch (`git push origin feature/amazing-feature`)
5. Open a Pull Request

## License

This project is licensed under the MIT License - see the LICENSE file for details.

## Acknowledgments

- [googletrans](https://github.com/ssut/py-googletrans) for providing the translation API wrapper
- Apple's XLIFF specification for localization
